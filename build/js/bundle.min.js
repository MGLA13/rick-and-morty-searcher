const selectedFilter="selected",limit=5,charactersInfoByInput={},urlResources={characters:"https://rickandmortyapi.com/api/character/"},filtersOptions=[{filterName:"status",options:["Alive","Dead","Unknown"]},{filterName:"species",options:["Human","Humanoid","Alien","Cronenberg","Poopybutthole","Mythological","Unknown"]},{filterName:"gender",options:["Male","Female","Genderless","Unknown"]}],currentFilters={};let arraySearching,total,contentDom=null,pastConditional=!1,consultNext=!1,inputValue="",range=1,limitCurrent=5,urlCurrent=urlResources.characters;function getDataAndDisplay(e,t=!1){let r=urlCurrent+e;new Promise(e=>{e(consumeApi(r))}).then(e=>{showData(e),t&&addButtons()}).catch()}function eventListeners(){document.querySelector("#clear-filters").addEventListener("click",clearFilters);document.querySelector(".mobile-filters").addEventListener("click",showFiltersMobile);document.querySelector(".filter-close-mobile-menu").addEventListener("click",closeFilterMobile);document.querySelector("#input-search").onkeyup=function(e){getInput(e)};document.querySelector("#previous").addEventListener("click",decRangeArray);document.querySelector("#next").addEventListener("click",incRangeArray);document.querySelectorAll(".option").forEach(e=>{e.onclick=function(e){addFilter(e)}})}function getTotalCharacters(){const e=new Array;new Promise(e=>{e(consumeApi(urlResources.characters))}).then(t=>{e.push(t),total=e.map(e=>e.info.count).toString();const r=document.createElement("P");r.innerHTML="<span>all characters are: </span> "+total;const n=document.createElement("P");n.textContent=`All rights reserved ${(new Date).getFullYear()} Â©`,document.querySelector(".info-footer").appendChild(r),document.querySelector(".footer").appendChild(n),urlResources.totalCharacters=parseInt(total)}).catch()}function addButtons(){const e=document.createElement("BUTTON");e.type="button",e.classList.add("blue-buttom-block","hidden"),e.id="previous",e.textContent="previous";const t=document.createElement("BUTTON");t.type="button",t.classList.add("blue-buttom-block"),t.id="next",t.textContent="next";const r=document.createElement("DIV");r.classList.add("buttons-container"),r.appendChild(e),r.appendChild(t),document.querySelector(".results-container").appendChild(r),addFiltersToDom()}function addFiltersToDom(){filtersOptions.forEach(e=>{const t=document.createElement("DIV");t.classList.add("filter","filter-search");const r=document.createElement("P");r.classList.add("filter-title"),r.textContent=e.filterName;const n=document.createElement("UL");n.classList.add("filter-search-options"),e.options.forEach(t=>{const r=document.createElement("LI");r.classList.add("option"),r.setAttribute("data-parameter",e.filterName),r.textContent=t,n.appendChild(r)}),t.appendChild(r),t.appendChild(n),document.querySelector(".filters-container").appendChild(t)}),eventListeners()}function incRangeArray(){(!pastConditional||charactersInfoByInput.countCharacters>5)&&(range+=limitCurrent,document.querySelector("#previous").classList.contains("hidden")&&document.querySelector("#previous").classList.remove("hidden"),changeArray(!1),urlResources.totalCharacters-(range+5)<0&&document.querySelector("#next").classList.add("hidden"))}function decRangeArray(){pastConditional&&(pastConditional=!1),range+5>urlResources.totalCharacters&&charactersInfoByInput.countCharacters>5&&(limitCurrent=5,document.querySelector("#next").classList.remove("hidden")),range=range-limitCurrent<1&&0===Object.keys(charactersInfoByInput).length?1:range-=limitCurrent,changeArray(!1),(1===range||0===range&&1===charactersInfoByInput.currentPage)&&document.querySelector("#previous").classList.add("hidden")}function changeArray(e){if(0!==Object.keys(charactersInfoByInput).length){if(range+5>urlResources.totalCharacters&&charactersInfoByInput.currentPage!==charactersInfoByInput.pages){charactersInfoByInput.currentPage++;const e=changeFilterSearching(charactersInfoByInput.currentPage,"page");urlCurrent=`${urlResources.characters}${e}`,range=0,new Promise(e=>{e(consumeApi(urlCurrent))}).then(e=>{charactersInfoByInput.characters=e.results,urlResources.totalCharacters=e.results.length,urlResources.totalCharacters-(range+5)<=0&&document.querySelector("#next").classList.add("hidden"),showData(charactersInfoByInput.characters.slice(range,range+5))}).catch()}else if(range<0&&1!==charactersInfoByInput.currentPage){charactersInfoByInput.currentPage--;const e=changeFilterSearching(charactersInfoByInput.currentPage,"page");urlCurrent=`${urlResources.characters}${e}`,new Promise(e=>{e(consumeApi(urlCurrent))}).then(e=>{charactersInfoByInput.characters=e.results,urlResources.totalCharacters=e.results.length,range=urlResources.totalCharacters-5,showData(charactersInfoByInput.characters.slice(range,range+5))}).catch()}else if(range>=0){let e=range+5;range+5>=urlResources.totalCharacters&&(e=urlResources.totalCharacters,pastConditional=!0),showData(charactersInfoByInput.characters.slice(range,e))}}else range+5>urlResources.totalCharacters&&(limitCurrent=urlResources.totalCharacters-range+1,pastConditional=!0),arraySearching=Array.from({length:limitCurrent},(e,t)=>t+range),getDataAndDisplay(arraySearching,e)}function addFilter(e){Array.from(e.target.parentElement.childNodes).forEach(t=>{t!==e.target||t.classList.contains("selected")?t.classList.contains("selected")&&t.classList.remove("selected"):e.target.classList.add("selected")});const t=changeFilterSearching(e.target.textContent,e.target.getAttribute("data-parameter"));urlCurrent=`${urlResources.characters}${t}`,consultNext||searchData()}function clearFilters(){Array.from(document.querySelectorAll(".option")).forEach(e=>{e.classList.contains("selected")&&e.classList.remove("selected")}),Object.keys(currentFilters).forEach(e=>{"name"!==e&&delete currentFilters[e]}),0!==Object.keys(currentFilters).length&&(currentFilters[Object.keys(currentFilters)[0]].characterQuery="?");const e=getUrlParameters();urlCurrent=`${urlResources.characters}${e}`,consultNext||searchData()}function showFiltersMobile(){contentDom=document.querySelector(".relative").cloneNode(!0);const e=Array.from(document.querySelector(".filters").childNodes),t=document.querySelector(".relative");for(;t.firstChild;)t.removeChild(t.firstChild);const r=document.createElement("SECTION");r.classList.add("filters","static"),e.forEach(e=>r.appendChild(e)),t.appendChild(r),consultNext=!0}function closeFilterMobile(){const e=Array.from(contentDom.childNodes),t=document.querySelector(".filters-container").cloneNode(!0),r=document.querySelector(".relative");for(;r.firstChild;)r.removeChild(r.firstChild);e.forEach(e=>r.appendChild(e)),document.querySelector(".filters-container").innerHTML=t.innerHTML;document.querySelector(".filters").classList.remove("static"),consultNext&&(searchData(),consultNext=!1),eventListeners()}function changeFilterSearching(e,t){const r=0===Object.keys(currentFilters).length?"?":"&";return currentFilters[t]||0===e.length?currentFilters[t].value===e||0===e.length?(delete currentFilters[t],0!==Object.keys(currentFilters).length&&(currentFilters[Object.keys(currentFilters)[0]].characterQuery="?")):currentFilters[t].value=e:currentFilters[t]={characterQuery:r,value:e},"page"!==t&&currentFilters.page&&delete currentFilters.page,getUrlParameters()}function getUrlParameters(){let e="";for(const[t,r]of Object.entries(currentFilters))e+=`${r.characterQuery}${t}=${r.value}`;return console.log(e),e}function getInput(e){inputValue=e.target.value;const t=changeFilterSearching(inputValue,"name");urlCurrent=`${urlResources.characters}${t}`,searchData()}function searchFilterWithoutResults(){let e=1,t=Object.keys(currentFilters).length,r=currentFilters.name&&t>e?" and filters ":"";for(const[n,a]of Object.entries(currentFilters))"name"!==n&&(r+=`${n}:<span> "${a.value}" </span>`,e<t&&(r+=" and ")),++e;return r}function searchData(){0!==inputValue.length||0!==Object.keys(currentFilters).length?new Promise(e=>{e(consumeApi(urlCurrent))}).then(e=>{if(e.hasOwnProperty("error")){const e=document.querySelector(".characters-container");for(;e.firstChild;)e.removeChild(e.firstChild);const t=document.createElement("H3");t.classList.add("message");const r=searchFilterWithoutResults();return t.innerHTML=`Not results for the entrance: <span>"${inputValue}"</span>${r}`,document.querySelector("#previous").classList.add("hidden"),document.querySelector("#next").classList.add("hidden"),void e.appendChild(t)}charactersInfoByInput.pages=e.info.pages,charactersInfoByInput.countCharacters=e.info.count,charactersInfoByInput.characters=e.results,charactersInfoByInput.currentPage=1,urlResources.totalCharacters=e.results.length,range=0,limitCurrent=5,pastConditional&&(pastConditional=!1),document.querySelector("#previous").classList.contains("hidden")||document.querySelector("#previous").classList.add("hidden"),charactersInfoByInput.countCharacters<=5&&document.querySelector("#next").classList.add("hidden"),showData(charactersInfoByInput.characters.slice(range,range+5))}).catch():(urlCurrent=urlResources.characters,Object.keys(charactersInfoByInput).forEach(e=>delete charactersInfoByInput[e]),range=1,urlResources.totalCharacters=total,document.querySelector("#previous").classList.contains("hidden")||document.querySelector("#previous").classList.add("hidden"),changeArray(!1))}async function consumeApi(e){try{const t=await fetch(e);return await t.json()}catch(e){}}function showData(e){const t=document.querySelector(".characters-container");let r=e;for(;t.firstChild;)t.removeChild(t.firstChild);Array.isArray(r)||(r=[e]),r.forEach(e=>{const r=e.image,n=[{type:"features",data:{name:e.name,status:e.status,specie:e.species}},{type:"additionals",data:[{title:"Last known location",info:e.location.name,consumeApi:!1},{title:"First seen in",info:e.episode[0],consumeApi:!0}]}],a=document.createElement("IMG");a.classList.add("h-100-cover"),a.setAttribute("src",r),a.setAttribute("alt","Character");const s=document.createElement("DIV");s.classList.add("image-result-container"),s.appendChild(a);const c=createFeatures(n),o=document.createElement("DIV");o.classList.add("result"),o.appendChild(s),o.appendChild(c),t.appendChild(o),t.scrollTop,urlResources.totalCharacters>5&&null!==document.querySelector("#next")&&document.querySelector("#next").classList.remove("hidden")})}function createFeatures(e){const t=document.createElement("DIV");return t.classList.add("features-result-container"),e.forEach(e=>{if("features"===e.type){let r=document.createElement("DIV");r.classList.add("result-info");const n=document.createElement("H3");n.textContent=e.data.name;const a=document.createElement("P");a.classList.add("info"),a.innerHTML="<span>Status: </span> "+e.data.status;const s=document.createElement("P");s.classList.add("info"),s.innerHTML="<span>Specie: </span> "+e.data.specie,r.appendChild(n),r.appendChild(a),r.appendChild(s),t.appendChild(r)}else e.data.forEach(e=>{const r=createAdditionalFeatures(e);t.appendChild(r)})}),t}function createAdditionalFeatures(e){const t=document.createElement("DIV");t.classList.add("result-info");const r=document.createElement("P");r.classList.add("text-gray"),r.textContent=e.title;const n=document.createElement("P");return n.classList.add("info"),e.consumeApi?new Promise(t=>{t(consumeApi(e.info))}).then(e=>getNameEpisodeCharacter(e)).then(e=>{n.textContent=e}).catch():n.textContent=e.info,t.appendChild(r),t.appendChild(n),t}function getNameEpisodeCharacter(e){const t=new Array;return t.push(e),t.map(e=>e.name).toString()}
/*! modernizr 3.6.0 (Custom Build) | MIT *
 * https://modernizr.com/download/?-webp-setclasses !*/document.addEventListener("DOMContentLoaded",(function(){getTotalCharacters(),changeArray(!0)})),function(e,t,r){function n(e,t){return typeof e===t}function a(e){var t=d.className,r=l._config.classPrefix||"";if(h&&(t=t.baseVal),l._config.enableJSClass){var n=new RegExp("(^|\\s)"+r+"no-js(\\s|$)");t=t.replace(n,"$1"+r+"js$2")}l._config.enableClasses&&(t+=" "+r+e.join(" "+r),h?d.className.baseVal=t:d.className=t)}function s(e,t){if("object"==typeof e)for(var r in e)u(e,r)&&s(r,e[r]);else{var n=(e=e.toLowerCase()).split("."),c=l[n[0]];if(2==n.length&&(c=c[n[1]]),void 0!==c)return l;t="function"==typeof t?t():t,1==n.length?l[n[0]]=t:(!l[n[0]]||l[n[0]]instanceof Boolean||(l[n[0]]=new Boolean(l[n[0]])),l[n[0]][n[1]]=t),a([(t&&0!=t?"":"no-")+n.join("-")]),l._trigger(e,t)}return l}var c=[],o=[],i={_version:"3.6.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var r=this;setTimeout((function(){t(r[e])}),0)},addTest:function(e,t,r){o.push({name:e,fn:t,options:r})},addAsyncTest:function(e){o.push({name:null,fn:e})}},l=function(){};l.prototype=i,l=new l;var u,d=t.documentElement,h="svg"===d.nodeName.toLowerCase();!function(){var e={}.hasOwnProperty;u=n(e,"undefined")||n(e.call,"undefined")?function(e,t){return t in e&&n(e.constructor.prototype[t],"undefined")}:function(t,r){return e.call(t,r)}}(),i._l={},i.on=function(e,t){this._l[e]||(this._l[e]=[]),this._l[e].push(t),l.hasOwnProperty(e)&&setTimeout((function(){l._trigger(e,l[e])}),0)},i._trigger=function(e,t){if(this._l[e]){var r=this._l[e];setTimeout((function(){var e;for(e=0;e<r.length;e++)(0,r[e])(t)}),0),delete this._l[e]}},l._q.push((function(){i.addTest=s})),l.addAsyncTest((function(){function e(e,t,r){function n(t){var n=!(!t||"load"!==t.type)&&1==a.width;s(e,"webp"===e&&n?new Boolean(n):n),r&&r(t)}var a=new Image;a.onerror=n,a.onload=n,a.src=t}var t=[{uri:"data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA=",name:"webp"},{uri:"data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA==",name:"webp.alpha"},{uri:"data:image/webp;base64,UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA",name:"webp.animation"},{uri:"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",name:"webp.lossless"}],r=t.shift();e(r.name,r.uri,(function(r){if(r&&"load"===r.type)for(var n=0;n<t.length;n++)e(t[n].name,t[n].uri)}))})),function(){var e,t,r,a,s,i;for(var u in o)if(o.hasOwnProperty(u)){if(e=[],(t=o[u]).name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(r=0;r<t.options.aliases.length;r++)e.push(t.options.aliases[r].toLowerCase());for(a=n(t.fn,"function")?t.fn():t.fn,s=0;s<e.length;s++)1===(i=e[s].split(".")).length?l[i[0]]=a:(!l[i[0]]||l[i[0]]instanceof Boolean||(l[i[0]]=new Boolean(l[i[0]])),l[i[0]][i[1]]=a),c.push((a?"":"no-")+i.join("-"))}}(),a(c),delete i.addTest,delete i.addAsyncTest;for(var p=0;p<l._q.length;p++)l._q[p]();e.Modernizr=l}(window,document);
//# sourceMappingURL=bundle.js.map
